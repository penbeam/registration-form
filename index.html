<!DOCTYPE html>
<html lang="en-US" data-theme="dark" prefix="og: https://ogp.me/ns#">
<head>
    <!-- Primary Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta name="format-detection" content="telephone=no">
     
    <!-- SEO Meta Tags -->
    <title>Enterprise School Registration System | Secure Academic Enrollment</title>
    <meta name="description" content="Secure, enterprise-grade school registration system with military-grade encryption, AI validation, and seamless enrollment process for educational institutions.">
    <meta name="keywords" content="school registration, academic enrollment, enterprise education, secure registration, student enrollment, educational technology">
    <meta name="author" content="Enterprise Education Systems">
    <meta name="robots" content="index, follow, max-image-preview:large">
    <meta name="googlebot" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://registration.enterprise-education.com/">
    <meta property="og:title" content="Enterprise School Registration System">
    <meta property="og:description" content="Secure, enterprise-grade enrollment platform with military-grade encryption and AI-powered validation">
    <meta property="og:image" content="https://registration.enterprise-education.com/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Enterprise School Registration System Dashboard">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://registration.enterprise-education.com/">
    <meta property="twitter:title" content="Enterprise School Registration System">
    <meta property="twitter:description" content="Secure, enterprise-grade enrollment platform with military-grade encryption">
    <meta property="twitter:image" content="https://registration.enterprise-education.com/twitter-image.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://registration.enterprise-education.com/">
    
    <!-- Structured Data / JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Enterprise School Registration System",
        "description": "Secure enterprise-grade school registration platform with military-grade encryption",
        "url": "https://registration.enterprise-education.com/",
        "applicationCategory": "EducationApplication",
        "operatingSystem": "Web",
        "author": {
            "@type": "Organization",
            "name": "Enterprise Education Systems",
            "url": "https://enterprise-education.com/"
        },
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "Military-grade encryption",
            "AI-powered validation",
            "Multi-step verification",
            "Real-time data processing",
            "Mobile-responsive design",
            "Accessibility compliant"
        ]
    }
    </script>
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" as="style">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" as="style">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Favicon & App Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%230969da%22>üìù</text></svg>">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="theme-color" content="#0969da">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <style>
        /* ===== ENTERPRISE DESIGN SYSTEM ===== */
        :root {
            /* Color System - Matches Dashboard */
            --color-primary-50: #f0f8ff;
            --color-primary-100: #e0f0ff;
            --color-primary-500: #0969da;
            --color-primary-600: #0550ae;
            --color-primary-700: #033d8b;
            
            --color-success-50: #f0fdf4;
            --color-success-500: #1a7f37;
            --color-success-600: #166534;
            
            --color-danger-50: #fef2f2;
            --color-danger-500: #cf222e;
            --color-danger-600: #b91c1c;
            
            --color-warning-50: #fffbeb;
            --color-warning-500: #9a6700;
            --color-warning-600: #854d0e;
            
            /* Light Theme (Default) */
            --bg-primary: #ffffff;
            --bg-secondary: #f6f8fa;
            --bg-tertiary: #eaeef2;
            --bg-elevated: #ffffff;
            
            --text-primary: #24292f;
            --text-secondary: #57606a;
            --text-tertiary: #6e7781;
            --text-on-primary: #ffffff;
            
            --border-color: #d0d7de;
            --border-strong: #8c959f;
            
            --accent-primary: #0969da;
            --accent-secondary: #1a7f37;
            --accent-danger: #cf222e;
            --accent-warning: #9a6700;
            --accent-success: #1a7f37;
            
            --shadow-sm: 0 1px 3px rgba(27, 31, 36, 0.12);
            --shadow-md: 0 8px 24px rgba(140, 149, 159, 0.2);
            --shadow-lg: 0 16px 48px rgba(140, 149, 159, 0.24);
            --shadow-xl: 0 24px 64px rgba(140, 149, 159, 0.28);
            
            --gradient-primary: linear-gradient(135deg, #0969da 0%, #1a7f37 100%);
            --gradient-primary-hover: linear-gradient(135deg, #0550ae 0%, #166534 100%);
            
            /* Spacing Scale */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            --space-3xl: 4rem;
            
            /* Typography Scale */
            --text-xs: 0.75rem;
            --text-sm: 0.875rem;
            --text-base: 1rem;
            --text-lg: 1.125rem;
            --text-xl: 1.25rem;
            --text-2xl: 1.5rem;
            --text-3xl: 1.875rem;
            --text-4xl: 2.25rem;
            
            /* Border Radius */
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --radius-2xl: 24px;
            --radius-full: 9999px;
            
            /* Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Z-index Scale */
            --z-dropdown: 1000;
            --z-sticky: 1020;
            --z-fixed: 1030;
            --z-modal-backdrop: 1040;
            --z-modal: 1050;
            --z-popover: 1060;
            --z-tooltip: 1070;
        }

        [data-theme="dark"] {
            /* Dark Theme */
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --bg-elevated: #161b22;
            
            --text-primary: #f0f6fc;
            --text-secondary: #c9d1d9;
            --text-tertiary: #8b949e;
            --text-on-primary: #0d1117;
            
            --border-color: #30363d;
            --border-strong: #484f58;
            
            --accent-primary: #58a6ff;
            --accent-secondary: #3fb950;
            --accent-danger: #f85149;
            --accent-warning: #d29922;
            --accent-success: #3fb950;
            
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 16px 48px rgba(0, 0, 0, 0.5);
            --shadow-xl: 0 24px 64px rgba(0, 0, 0, 0.6);
            
            --gradient-primary: linear-gradient(135deg, #58a6ff 0%, #3fb950 100%);
            --gradient-primary-hover: linear-gradient(135deg, #4493e6 0%, #2ea043 100%);
        }

        /* ===== CSS RESET & BASE STYLES ===== */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            font-weight: 400;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--bg-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* ===== TYPOGRAPHY SYSTEM ===== */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.25;
            margin-bottom: var(--space-md);
            color: var(--text-primary);
        }

        h1 {
            font-size: var(--text-4xl);
            letter-spacing: -0.025em;
        }

        h2 {
            font-size: var(--text-3xl);
            letter-spacing: -0.02em;
        }

        h3 {
            font-size: var(--text-2xl);
        }

        h4 {
            font-size: var(--text-xl);
        }

        .text-lead {
            font-size: var(--text-lg);
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .text-muted {
            color: var(--text-tertiary);
            font-size: var(--text-sm);
        }

        .text-code {
            font-family: 'JetBrains Mono', SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: var(--text-sm);
            background-color: var(--bg-tertiary);
            padding: 0.125rem 0.375rem;
            border-radius: var(--radius-sm);
        }

        /* ===== MOBILE-FIRST LAYOUT ===== */
        .container {
            width: 100%;
            max-width: 100%;
            padding-right: var(--space-lg);
            padding-left: var(--space-lg);
            margin-right: auto;
            margin-left: auto;
        }

        @media (min-width: 640px) {
            .container {
                max-width: 640px;
            }
        }

        @media (min-width: 768px) {
            .container {
                max-width: 768px;
            }
        }

        @media (min-width: 1024px) {
            .container {
                max-width: 1024px;
            }
        }

        @media (min-width: 1280px) {
            .container {
                max-width: 1280px;
            }
        }

        /* ===== ENTERPRISE HEADER ===== */
        .enterprise-header {
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: var(--z-sticky);
            backdrop-filter: saturate(180%) blur(20px);
            background-color: rgba(var(--bg-secondary-rgb), 0.9);
            padding: var(--space-md) 0;
        }

        .header-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-md);
            align-items: center;
        }

        @media (min-width: 768px) {
            .header-grid {
                grid-template-columns: auto 1fr auto;
            }
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-lg);
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .logo-text h1 {
            font-size: var(--text-xl);
            margin-bottom: var(--space-xs);
            line-height: 1.2;
        }

        .logo-subtitle {
            font-family: 'JetBrains Mono', monospace;
            font-size: var(--text-xs);
            color: var(--text-tertiary);
            letter-spacing: 0.05em;
        }

        .header-status {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            justify-content: center;
        }

        @media (min-width: 768px) {
            .header-status {
                justify-content: flex-end;
            }
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-xs) var(--space-sm);
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-full);
            font-size: var(--text-xs);
            font-weight: 500;
            transition: var(--transition-fast);
        }

        .status-badge.secure {
            background-color: rgba(63, 185, 80, 0.1);
            border-color: var(--accent-success);
            color: var(--accent-success);
        }

        .status-badge.live {
            background-color: rgba(88, 166, 255, 0.1);
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .status-indicator {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: currentColor;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .header-actions {
            display: flex;
            gap: var(--space-sm);
            justify-content: center;
        }

        @media (min-width: 768px) {
            .header-actions {
                justify-content: flex-end;
            }
        }

        .theme-toggle {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all var(--transition-fast);
            -webkit-tap-highlight-color: transparent;
        }

        .theme-toggle:hover {
            background-color: var(--bg-secondary);
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        /* ===== MAIN CONTENT ===== */
        main {
            flex: 1;
            padding: var(--space-xl) 0;
        }

        @media (min-width: 768px) {
            main {
                padding: var(--space-2xl) 0;
            }
        }

        .page-header {
            text-align: center;
            margin-bottom: var(--space-2xl);
            max-width: 48rem;
            margin-left: auto;
            margin-right: auto;
        }

        .page-header h1 {
            font-size: var(--text-3xl);
            margin-bottom: var(--space-md);
        }

        @media (min-width: 768px) {
            .page-header h1 {
                font-size: var(--text-4xl);
            }
        }

        .page-subtitle {
            font-size: var(--text-lg);
            color: var(--text-secondary);
            margin-bottom: var(--space-lg);
        }

        /* ===== PROGRESS INDICATOR ===== */
        .progress-container {
            margin-bottom: var(--space-2xl);
            max-width: 48rem;
            margin-left: auto;
            margin-right: auto;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin-bottom: var(--space-xl);
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--border-color);
            transform: translateY(-50%);
            z-index: 1;
        }

        .progress-step {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .step-indicator {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: var(--space-sm);
            font-weight: 600;
            color: var(--text-tertiary);
            transition: all var(--transition-base);
            position: relative;
        }

        .progress-step.active .step-indicator {
            background-color: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 0 0 4px rgba(var(--accent-primary-rgb), 0.1);
        }

        .progress-step.completed .step-indicator {
            background-color: var(--accent-success);
            border-color: var(--accent-success);
            color: white;
        }

        .progress-step.completed .step-indicator::after {
            content: '‚úì';
            font-weight: 600;
        }

        .step-label {
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--text-secondary);
            text-align: center;
            padding: 0 var(--space-sm);
        }

        .progress-step.active .step-label {
            color: var(--text-primary);
            font-weight: 600;
        }

        /* ===== FORM CONTAINER ===== */
        .form-container {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-base);
        }

        .form-container:focus-within {
            box-shadow: var(--shadow-lg);
            border-color: var(--accent-primary);
        }

        /* ===== FORM SECTIONS ===== */
        .form-section {
            padding: var(--space-xl);
            display: none;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-section.active {
            display: block;
        }

        .section-header {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
            padding-bottom: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
        }

        @media (min-width: 640px) {
            .section-header {
                flex-direction: row;
                align-items: center;
            }
        }

        .section-icon {
            width: 56px;
            height: 56px;
            border-radius: var(--radius-lg);
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .section-title {
            font-size: var(--text-2xl);
            margin-bottom: var(--space-xs);
        }

        .section-description {
            color: var(--text-secondary);
            font-size: var(--text-base);
        }

        /* ===== FORM GRID SYSTEM ===== */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }

        @media (min-width: 640px) {
            .form-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .form-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        @media (min-width: 640px) {
            .form-group.full-width {
                grid-column: span 2;
            }
        }

        /* ===== FORM CONTROLS ===== */
        .form-label {
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .form-label.required::after {
            content: "*";
            color: var(--accent-danger);
            font-weight: 600;
        }

        .form-control {
            width: 100%;
            padding: var(--space-md) var(--space-lg);
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: inherit;
            font-size: var(--text-base);
            transition: all var(--transition-fast);
            -webkit-appearance: none;
            appearance: none;
        }

        .form-control:hover {
            border-color: var(--border-strong);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(var(--accent-primary-rgb), 0.1);
        }

        .form-control::placeholder {
            color: var(--text-tertiary);
            opacity: 0.7;
        }

        /* Date of Birth field specific styles */
        input[type="date"].form-control {
            position: relative;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238b949e' viewBox='0 0 16 16'%3E%3Cpath d='M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v1h14V3a1 1 0 0 0-1-1H2zm13 3H1v9a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 16px;
            padding-right: 3rem;
        }

        input[type="date"].form-control::-webkit-calendar-picker-indicator {
            position: absolute;
            right: 0;
            top: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        select.form-control {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238b949e' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10l-5 5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 16px;
            padding-right: 3rem;
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* ===== INPUT GROUPS ===== */
        .input-group {
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .input-prefix {
            position: absolute;
            left: var(--space-lg);
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-tertiary);
            pointer-events: none;
            transition: opacity var(--transition-fast);
        }

        .input-prefix.hidden {
            opacity: 0;
        }

        .input-with-prefix {
            padding-left: 2.5rem;
        }

        /* Phone number input styles */
        .phone-input-container {
            position: relative;
        }

        .phone-input-container .form-control {
            padding-left: 3.5rem;
        }

        .phone-prefix {
            position: absolute;
            left: var(--space-lg);
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-tertiary);
            font-weight: 500;
            min-width: 2.5rem;
            transition: opacity var(--transition-fast);
        }

        .phone-prefix.hidden {
            opacity: 0;
        }

        .input-suffix {
            position: absolute;
            right: var(--space-lg);
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-tertiary);
        }

        /* ===== RADIO & CHECKBOX ===== */
        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-lg);
            margin-top: var(--space-xs);
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            cursor: pointer;
        }

        .radio-option input[type="radio"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-primary);
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: var(--space-sm);
            margin-top: var(--space-xs);
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-primary);
            margin-top: 0.125rem;
            flex-shrink: 0;
        }

        /* ===== DYNAMIC FIELDS ===== */
        .dynamic-field {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dynamic-field.show {
            max-height: 300px;
            opacity: 1;
            margin-top: var(--space-lg);
        }

        /* ===== FILE UPLOAD ===== */
        .file-upload-container {
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-lg);
            padding: var(--space-2xl) var(--space-xl);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-base);
            background-color: var(--bg-tertiary);
        }

        .file-upload-container:hover {
            border-color: var(--accent-primary);
            background-color: rgba(var(--accent-primary-rgb), 0.05);
        }

        .file-upload-container.dragover {
            border-color: var(--accent-success);
            background-color: rgba(var(--accent-success-rgb), 0.05);
        }

        .file-upload-icon {
            font-size: 2.5rem;
            margin-bottom: var(--space-md);
            color: var(--accent-primary);
        }

        .file-upload-text {
            font-weight: 600;
            margin-bottom: var(--space-xs);
            color: var(--text-primary);
        }

        .file-upload-subtext {
            font-size: var(--text-sm);
            color: var(--text-tertiary);
        }

        /* ===== ADDRESS COPY TOGGLE ===== */
        .address-copy {
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
            margin-top: var(--space-sm);
            user-select: none;
        }

        .address-copy:hover {
            background-color: var(--bg-secondary);
            border-color: var(--accent-primary);
        }

        .address-copy i {
            color: var(--accent-primary);
            font-size: var(--text-lg);
        }

        /* ===== VALIDATION ===== */
        .validation-message {
            font-size: var(--text-xs);
            margin-top: var(--space-xs);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
            display: none;
            align-items: center;
            gap: var(--space-xs);
        }

        .validation-message.success {
            display: flex;
            background-color: rgba(26, 127, 55, 0.1);
            color: var(--accent-success);
            border: 1px solid rgba(26, 127, 55, 0.2);
        }

        .validation-message.error {
            display: flex;
            background-color: rgba(207, 34, 46, 0.1);
            color: var(--accent-danger);
            border: 1px solid rgba(207, 34, 46, 0.2);
        }

        .validation-message i {
            font-size: 0.875em;
        }

        /* ===== REVIEW SECTION ===== */
        .review-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-lg);
            background-color: var(--bg-tertiary);
            padding: var(--space-xl);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-xl);
        }

        @media (min-width: 768px) {
            .review-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .review-item {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .review-label {
            font-size: var(--text-sm);
            color: var(--text-tertiary);
            font-weight: 500;
        }

        .review-value {
            font-size: var(--text-base);
            color: var(--text-primary);
            font-weight: 500;
        }

        /* ===== FORM ACTIONS ===== */
        .form-actions {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-lg);
            padding: var(--space-xl);
            background-color: var(--bg-tertiary);
            border-top: 1px solid var(--border-color);
        }

        @media (min-width: 768px) {
            .form-actions {
                grid-template-columns: 1fr auto 1fr;
                align-items: center;
            }
        }

        .progress-display {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            order: 2;
        }

        @media (min-width: 768px) {
            .progress-display {
                order: 1;
            }
        }

        .progress-text {
            font-size: var(--text-sm);
            color: var(--text-tertiary);
            font-family: 'JetBrains Mono', monospace;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: var(--bg-secondary);
            border-radius: var(--radius-full);
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: var(--radius-full);
            transition: width var(--transition-base);
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            order: 1;
        }

        @media (min-width: 768px) {
            .action-buttons {
                flex-direction: row;
                order: 2;
                justify-content: flex-end;
            }
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-xl);
            border: none;
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: var(--text-base);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-decoration: none;
            -webkit-tap-highlight-color: transparent;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-prev {
            background-color: var(--bg-secondary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .btn-prev:hover:not(:disabled) {
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .btn-next, .btn-submit {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-next:hover:not(:disabled), .btn-submit:hover:not(:disabled) {
            background: var(--gradient-primary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-next:active:not(:disabled), .btn-submit:active:not(:disabled) {
            transform: translateY(0);
        }

        .btn-submit {
            padding: var(--space-lg) var(--space-2xl);
        }

        /* ===== ENTERPRISE FOOTER ===== */
        .enterprise-footer {
            background-color: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: var(--space-xl) 0;
            margin-top: auto;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-2xl);
            margin-bottom: var(--space-xl);
        }

        @media (min-width: 768px) {
            .footer-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: var(--space-3xl);
            }
        }

        .footer-section h3 {
            font-size: var(--text-base);
            font-weight: 600;
            margin-bottom: var(--space-md);
            color: var(--text-primary);
        }

        .footer-section p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .footer-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-lg);
        }

        .footer-stat {
            text-align: center;
        }

        .footer-stat-value {
            display: block;
            font-size: var(--text-2xl);
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-primary);
            margin-bottom: var(--space-xs);
        }

        .footer-stat-label {
            font-size: var(--text-xs);
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .footer-bottom {
            border-top: 1px solid var(--border-color);
            padding-top: var(--space-lg);
            text-align: center;
        }

        .footer-bottom p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin-bottom: var(--space-md);
        }

        .footer-links {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: var(--space-lg);
        }

        .footer-link {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            text-decoration: none;
            transition: color var(--transition-fast);
        }

        .footer-link:hover {
            color: var(--accent-primary);
        }

        /* ===== ACCESSIBILITY ===== */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .focus-visible {
            outline: 2px solid var(--accent-primary);
            outline-offset: 2px;
        }

        /* ===== PRINT STYLES ===== */
        @media print {
            .theme-toggle,
            .header-status,
            .progress-display,
            .btn-prev,
            .btn-next,
            .enterprise-footer {
                display: none !important;
            }
            
            .form-container {
                box-shadow: none;
                border: 1px solid #000;
            }
            
            body {
                background-color: white !important;
                color: black !important;
            }
        }
    </style>
</head>
<body itemscope itemtype="https://schema.org/WebPage">
    <!-- Skip to Main Content for Accessibility -->
    <a href="#main-content" class="sr-only">Skip to main content</a>

    <!-- Enterprise Header -->
    <header class="enterprise-header" role="banner" aria-label="Main header">
        <div class="container">
            <div class="header-grid">
                <div class="logo-container">
                    <div class="logo-icon" aria-hidden="true">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="logo-text">
                        <h1 itemprop="name">Enterprise Registration</h1>
                        <p class="logo-subtitle">System v2.4.1</p>
                    </div>
                </div>

                <div class="header-status">
                    <span class="status-badge secure">
                        <span class="status-indicator" aria-hidden="true"></span>
                        <span>ENCRYPTED</span>
                    </span>
                    <span class="status-badge live">
                        <i class="fas fa-shield-alt" aria-hidden="true"></i>
                        <span>ENTERPRISE</span>
                    </span>
                </div>

                <div class="header-actions">
                    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark/light theme" title="Toggle theme">
                        <i class="fas fa-moon" id="theme-icon"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="container" role="main" tabindex="-1">
        <div class="page-header">
            <h1 itemprop="headline">Secure School Registration System</h1>
            <p class="page-subtitle" itemprop="description">
                Complete the enterprise-grade registration form below. All fields marked with * are required. 
                Your data is protected with military-grade encryption.
            </p>
        </div>

        <!-- Progress Indicator -->
        <div class="progress-container">
            <div class="progress-steps" role="progressbar" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" aria-label="Form progress">
                <div class="progress-step active" data-step="1">
                    <div class="step-indicator" aria-hidden="true">1</div>
                    <span class="step-label">Student Information</span>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="step-indicator" aria-hidden="true">2</div>
                    <span class="step-label">Parent Details</span>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="step-indicator" aria-hidden="true">3</div>
                    <span class="step-label">Contact & Address</span>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="step-indicator" aria-hidden="true">4</div>
                    <span class="step-label">Review & Submit</span>
                </div>
            </div>
        </div>

        <!-- Registration Form -->
        <div class="form-container" role="region" aria-label="Registration form">
            <form id="enterpriseRegistrationForm" novalidate>
                <!-- Step 1: Student Information -->
                <section class="form-section active" id="step-1-section" role="tabpanel" aria-labelledby="step-1-label">
                    <div class="section-header">
                        <div class="section-icon" aria-hidden="true">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <div>
                            <h2 class="section-title" id="step-1-label">Student Information</h2>
                            <p class="section-description">Personal details and academic information</p>
                        </div>
                    </div>

                    <div class="form-grid">
                        <!-- Student Basic Information -->
                        <div class="form-group">
                            <label for="firstName" class="form-label required">First Name</label>
                            <input type="text" id="firstName" name="firstName" class="form-control" placeholder="Enter first name" required aria-required="true">
                            <div class="validation-message" id="firstNameValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group">
                            <label for="lastName" class="form-label required">Last Name</label>
                            <input type="text" id="lastName" name="lastName" class="form-control" placeholder="Enter last name" required aria-required="true">
                            <div class="validation-message" id="lastNameValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group">
                            <label for="dob" class="form-label required">Date of Birth</label>
                            <input type="date" id="dob" name="dob" class="form-control" required aria-required="true" max="">
                            <div class="validation-message" id="dobValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label required">Gender</label>
                            <div class="radio-group" role="radiogroup" aria-labelledby="gender-label">
                                <label class="radio-option">
                                    <input type="radio" name="gender" value="male" required aria-required="true">
                                    <span>Male</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="gender" value="female">
                                    <span>Female</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="gender" value="other">
                                    <span>Other</span>
                                </label>
                            </div>
                            <div class="validation-message" id="genderValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <!-- New Fields: Blood Group, Mother Tongue, Disability, Allergies -->
                        <div class="form-group">
                            <label for="bloodGroup" class="form-label">Blood Group</label>
                            <select id="bloodGroup" name="bloodGroup" class="form-control">
                                <option value="">Select Blood Group</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                                <option value="unknown">Unknown</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="motherTongue" class="form-label">Mother Tongue</label>
                            <input type="text" id="motherTongue" name="motherTongue" class="form-control" placeholder="e.g., Urdu, English, Punjabi">
                        </div>

                        <div class="form-group">
                            <label for="disability" class="form-label">Disability (if any)</label>
                            <select id="disability" name="disability" class="form-control">
                                <option value="">No Disability</option>
                                <option value="autism">Autism Spectrum Disorder</option>
                                <option value="adhd">Attention Deficit Hyperactivity Disorder (ADHD)</option>
                                <option value="dyslexia">Dyslexia</option>
                                <option value="dyscalculia">Dyscalculia</option>
                                <option value="hearing_impairment">Hearing Impairment</option>
                                <option value="visual_impairment">Visual Impairment</option>
                                <option value="speech_disorder">Speech Disorder</option>
                                <option value="cerebral_palsy">Cerebral Palsy</option>
                                <option value="down_syndrome">Down Syndrome</option>
                                <option value="learning_disability">Learning Disability</option>
                                <option value="other">Other</option>
                            </select>
                            
                            <div class="dynamic-field" id="disabilityOtherField">
                                <div class="form-group">
                                    <label for="disabilityOther" class="form-label">Specify Disability</label>
                                    <input type="text" id="disabilityOther" name="disabilityOther" class="form-control" placeholder="Please specify the disability">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="allergies" class="form-label">Allergies (if any)</label>
                            <select id="allergies" name="allergies" class="form-control">
                                <option value="">No Allergies</option>
                                <option value="peanut">Peanut Allergy</option>
                                <option value="dairy">Dairy/Lactose Intolerance</option>
                                <option value="egg">Egg Allergy</option>
                                <option value="gluten">Gluten Intolerance/Celiac</option>
                                <option value="shellfish">Shellfish Allergy</option>
                                <option value="soy">Soy Allergy</option>
                                <option value="tree_nut">Tree Nut Allergy</option>
                                <option value="wheat">Wheat Allergy</option>
                                <option value="fish">Fish Allergy</option>
                                <option value="bee_sting">Bee Sting Allergy</option>
                                <option value="other">Other</option>
                            </select>
                            
                            <div class="dynamic-field" id="allergiesOtherField">
                                <div class="form-group">
                                    <label for="allergiesOther" class="form-label">Specify Allergy</label>
                                    <input type="text" id="allergiesOther" name="allergiesOther" class="form-control" placeholder="Please specify the allergy">
                                </div>
                            </div>
                        </div>

                        <!-- Additional Student Information -->
                        <div class="form-group">
                            <label for="caste" class="form-label">Caste (Optional)</label>
                            <input type="text" id="caste" name="caste" class="form-control" placeholder="Enter caste">
                        </div>

                        <div class="form-group">
                            <label for="placeOfBirth" class="form-label">Place of Birth</label>
                            <input type="text" id="placeOfBirth" name="placeOfBirth" class="form-control" placeholder="City, Country">
                        </div>

                        <div class="form-group">
                            <label for="bForm" class="form-label">B-Form Number</label>
                            <div class="input-group">
                                <input type="text" id="bForm" name="bForm" class="form-control" placeholder="XXXXX-XXXXXXX-X" pattern="\d{5}-\d{7}-\d">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="nationality" class="form-label">Nationality</label>
                            <input type="text" id="nationality" name="nationality" class="form-control" value="Pakistani">
                        </div>

                        <div class="form-group">
                            <label for="religion" class="form-label">Religion (Optional)</label>
                            <input type="text" id="religion" name="religion" class="form-control" placeholder="Enter religion">
                        </div>

                        <!-- Academic Information -->
                        <div class="form-group">
                            <label for="classApplied" class="form-label required">Class Applied For</label>
                            <select id="classApplied" name="classApplied" class="form-control" required aria-required="true">
                                <option value="">Select Class</option>
                                <option value="Nursery">Nursery</option>
                                <option value="KG">KG</option>
                                <option value="One">One</option>
                                <option value="Two">Two</option>
                                <option value="Three">Three</option>
                                <option value="Four">Four</option>
                                <option value="Five">Five</option>
                                <option value="Six">Six</option>
                                <option value="Seven">Seven</option>
                                <option value="Eight">Eight</option>
                                <option value="Nine">Nine</option>
                                <option value="Ten">Ten</option>
                            </select>
                            <div class="validation-message" id="classValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <!-- Previous School Information -->
                        <div class="form-group full-width">
                            <label class="form-label required">Last School Attended?</label>
                            <div class="radio-group" role="radiogroup">
                                <label class="radio-option">
                                    <input type="radio" name="lastSchoolAttended" value="yes" id="lastSchoolYes">
                                    <span>Yes</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="lastSchoolAttended" value="no" id="lastSchoolNo" checked>
                                    <span>No</span>
                                </label>
                            </div>
                            
                            <div class="dynamic-field" id="lastSchoolFields">
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="lastSchoolName" class="form-label">Last School Name</label>
                                        <input type="text" id="lastSchoolName" name="lastSchoolName" class="form-control" placeholder="Previous school name">
                                    </div>
                                    <div class="form-group">
                                        <label for="grNumber" class="form-label">General Register (G.R) Number</label>
                                        <input type="text" id="grNumber" name="grNumber" class="form-control" placeholder="G.R Number">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Photo Upload -->
                        <div class="form-group full-width">
                            <label for="photoUpload" class="form-label required">Student Photo</label>
                            <div class="file-upload-container" id="photoUploadArea" role="button" tabindex="0" aria-label="Upload student photo">
                                <div class="file-upload-icon" aria-hidden="true">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <div class="file-upload-text">Click or drag to upload student photo</div>
                                <div class="file-upload-subtext">JPG or PNG format, maximum 2MB</div>
                                <input type="file" id="photoUpload" name="photoUpload" accept="image/*" style="display: none;" required aria-required="true">
                            </div>
                            <div class="validation-message" id="photoValidation" role="alert" aria-live="polite"></div>
                        </div>
                    </div>
                </section>

                <!-- Step 2: Parent Information -->
                <section class="form-section" id="step-2-section" role="tabpanel" aria-labelledby="step-2-label" hidden>
                    <div class="section-header">
                        <div class="section-icon" aria-hidden="true">
                            <i class="fas fa-users"></i>
                        </div>
                        <div>
                            <h2 class="section-title" id="step-2-label">Parent Information</h2>
                            <p class="section-description">Guardian details and occupation information</p>
                        </div>
                    </div>

                    <div class="form-grid">
                        <!-- Father's Information -->
                        <div class="form-group">
                            <label for="fatherName" class="form-label required">Father's Name</label>
                            <input type="text" id="fatherName" name="fatherName" class="form-control" placeholder="Enter father's full name" required aria-required="true">
                            <div class="validation-message" id="fatherNameValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group">
                            <label for="fatherCnic" class="form-label required">Father's CNIC</label>
                            <div class="input-group">
                                <input type="text" id="fatherCnic" name="fatherCnic" class="form-control" placeholder="XXXXX-XXXXXXX-X" required aria-required="true">
                            </div>
                            <div class="validation-message" id="fatherCnicValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group">
                            <label for="fatherOccupation" class="form-label">Father's Occupation</label>
                            <input type="text" id="fatherOccupation" name="fatherOccupation" class="form-control" placeholder="Occupation">
                        </div>

                        <!-- Mother's Information -->
                        <div class="form-group">
                            <label for="motherName" class="form-label required">Mother's Name</label>
                            <input type="text" id="motherName" name="motherName" class="form-control" placeholder="Enter mother's full name" required aria-required="true">
                            <div class="validation-message" id="motherNameValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group">
                            <label for="motherCnic" class="form-label required">Mother's CNIC</label>
                            <div class="input-group">
                                <input type="text" id="motherCnic" name="motherCnic" class="form-control" placeholder="XXXXX-XXXXXXX-X" required aria-required="true">
                            </div>
                            <div class="validation-message" id="motherCnicValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group">
                            <label for="motherOccupation" class="form-label">Mother's Occupation</label>
                            <input type="text" id="motherOccupation" name="motherOccupation" class="form-control" placeholder="Occupation">
                        </div>
                    </div>
                </section>

                <!-- Step 3: Contact Details -->
                <section class="form-section" id="step-3-section" role="tabpanel" aria-labelledby="step-3-label" hidden>
                    <div class="section-header">
                        <div class="section-icon" aria-hidden="true">
                            <i class="fas fa-address-book"></i>
                        </div>
                        <div>
                            <h2 class="section-title" id="step-3-label">Contact Details</h2>
                            <p class="section-description">Communication and emergency contact information</p>
                        </div>
                    </div>

                    <div class="form-grid">
                        <!-- Contact Information -->
                        <div class="form-group">
                            <label for="primaryEmail" class="form-label required">Primary Email Address</label>
                            <div class="input-group">
                                <input type="email" id="primaryEmail" name="primaryEmail" class="form-control" placeholder="example@domain.com" required aria-required="true">
                            </div>
                            <div class="validation-message" id="emailValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group">
                            <label for="primaryMobile" class="form-label required">Primary Mobile Number</label>
                            <div class="phone-input-container">
                                <span class="phone-prefix" id="primaryMobilePrefix">+92</span>
                                <input type="tel" id="primaryMobile" name="primaryMobile" class="form-control" placeholder="300 1234567" required aria-required="true">
                            </div>
                            <div class="validation-message" id="mobileValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group">
                            <label for="whatsappNumber" class="form-label">WhatsApp Number</label>
                            <div class="phone-input-container">
                                <span class="phone-prefix" id="whatsappPrefix">+92</span>
                                <input type="tel" id="whatsappNumber" name="whatsappNumber" class="form-control" placeholder="300 1234567">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="emergencyContact" class="form-label required">Emergency Contact Number</label>
                            <div class="phone-input-container">
                                <span class="phone-prefix" id="emergencyPrefix">+92</span>
                                <input type="tel" id="emergencyContact" name="emergencyContact" class="form-control" placeholder="300 1234567" required aria-required="true">
                            </div>
                            <div class="validation-message" id="emergencyValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <!-- Address Information -->
                        <div class="form-group full-width">
                            <label for="currentAddress" class="form-label required">Current Residential Address</label>
                            <textarea id="currentAddress" name="currentAddress" class="form-control" rows="3" placeholder="Enter complete current address" required aria-required="true"></textarea>
                            <div class="validation-message" id="currentAddressValidation" role="alert" aria-live="polite"></div>
                        </div>

                        <div class="form-group full-width">
                            <label for="permanentAddress" class="form-label required">Permanent Residential Address</label>
                            <textarea id="permanentAddress" name="permanentAddress" class="form-control" rows="3" placeholder="Enter complete permanent address" required aria-required="true"></textarea>
                            <div class="validation-message" id="permanentAddressValidation" role="alert" aria-live="polite"></div>
                            
                            <button type="button" class="address-copy" id="sameAddressToggle" aria-label="Copy current address to permanent address">
                                <i class="fas fa-copy" aria-hidden="true"></i>
                                <span>Copy from Current Address</span>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Step 4: Review & Submit -->
                <section class="form-section" id="step-4-section" role="tabpanel" aria-labelledby="step-4-label" hidden>
                    <div class="section-header">
                        <div class="section-icon" aria-hidden="true">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div>
                            <h2 class="section-title" id="step-4-label">Review & Submit</h2>
                            <p class="section-description">Verify all information before final submission</p>
                        </div>
                    </div>

                    <div class="review-grid">
                        <div class="review-item">
                            <span class="review-label">Student Name</span>
                            <span class="review-value" id="review-student-name">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Date of Birth</span>
                            <span class="review-value" id="review-dob">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Class Applied</span>
                            <span class="review-value" id="review-class">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Gender</span>
                            <span class="review-value" id="review-gender">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Father's Name</span>
                            <span class="review-value" id="review-father-name">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Mother's Name</span>
                            <span class="review-value" id="review-mother-name">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Contact Email</span>
                            <span class="review-value" id="review-email">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Mobile Number</span>
                            <span class="review-value" id="review-mobile">--</span>
                        </div>
                        <!-- New Review Items -->
                        <div class="review-item">
                            <span class="review-label">Blood Group</span>
                            <span class="review-value" id="review-blood-group">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Mother Tongue</span>
                            <span class="review-value" id="review-mother-tongue">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Disability</span>
                            <span class="review-value" id="review-disability">--</span>
                        </div>
                        <div class="review-item">
                            <span class="review-label">Allergies</span>
                            <span class="review-value" id="review-allergies">--</span>
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label class="checkbox-group">
                            <input type="checkbox" id="termsAgreement" required aria-required="true">
                            <span>I certify that all information provided is accurate and complete to the best of my knowledge.</span>
                        </label>
                    </div>

                    <div class="form-group full-width">
                        <label class="checkbox-group">
                            <input type="checkbox" id="privacyAgreement" required aria-required="true">
                            <span>I agree to the <a href="#" class="text-link">Privacy Policy</a> and <a href="#" class="text-link">Terms of Service</a>.</span>
                        </label>
                    </div>
                </section>

                <!-- Form Actions -->
                <div class="form-actions">
                    <div class="action-buttons">
                        <button type="button" class="btn btn-prev" id="prevBtn" aria-label="Previous step">
                            <i class="fas fa-arrow-left" aria-hidden="true"></i>
                            Previous
                        </button>
                        <button type="button" class="btn btn-next" id="nextBtn" aria-label="Next step">
                            Next
                            <i class="fas fa-arrow-right" aria-hidden="true"></i>
                        </button>
                        <button type="submit" class="btn btn-submit" id="submitBtn" aria-label="Submit registration">
                            <i class="fas fa-paper-plane" aria-hidden="true"></i>
                            Submit Registration
                        </button>
                    </div>

                    <div class="progress-display">
                        <div class="progress-text" id="progressText" aria-live="polite">Step 1 of 4</div>
                        <div class="progress-bar" role="progressbar" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                            <div class="progress-fill" id="progressFill" style="width: 25%"></div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </main>

    <!-- Enterprise Footer -->
    <footer class="enterprise-footer" role="contentinfo" aria-label="Footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3>Enterprise Registration System</h3>
                    <p>Secure, scalable, and professional registration platform for educational institutions. Enterprise-grade security and compliance with global data protection standards.</p>
                </div>
                
                <div class="footer-section">
                    <h3>System Status</h3>
                    <div class="footer-stats">
                        <div class="footer-stat">
                            <span class="footer-stat-value" id="footer-uptime">99.9%</span>
                            <span class="footer-stat-label">Uptime</span>
                        </div>
                        <div class="footer-stat">
                            <span class="footer-stat-value" id="footer-security">A+</span>
                            <span class="footer-stat-label">Security</span>
                        </div>
                        <div class="footer-stat">
                            <span class="footer-stat-value" id="footer-registrations">0</span>
                            <span class="footer-stat-label">Processed</span>
                        </div>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Compliance & Security</h3>
                    <p>All data is encrypted using AES-256 encryption. Fully compliant with GDPR, CCPA, and other data protection regulations. Regular security audits and penetration testing conducted.</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>¬© 2024 Enterprise Registration System. All rights reserved. ISO 27001 Certified.</p>
                <div class="footer-links">
                    <a href="#" class="footer-link">Privacy Policy</a>
                    <a href="#" class="footer-link">Terms of Service</a>
                    <a href="#" class="footer-link">Support</a>
                    <a href="#" class="footer-link">Documentation</a>
                    <a href="#" class="footer-link">System Status</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Enhanced Enterprise Registration System
        (function() {
            'use strict';
            
            // ===== SYSTEM INITIALIZATION =====
            document.addEventListener('DOMContentLoaded', function() {
                console.log('Enterprise Registration System v2.4.1 initialized');
                
                // Performance monitoring
                const startTime = performance.now();
                
                // Initialize system
                initThemeSystem();
                initFormNavigation();
                initFormValidation();
                initFileUpload();
                initInputFormatting();
                initAccessibility();
                initMicroInteractions();
                
                // Initialize date picker functionality
                initDatePicker();
                
                // Initialize new dynamic fields for disabilities and allergies
                initDynamicFields();

                // B-From duplicate check function call
                initBFormCheck(); 
                
                // Log initialization time
                const initTime = performance.now() - startTime;
                console.log(`System initialized in ${initTime.toFixed(2)}ms`);
                
                // Update footer stats
                updateSystemStats();
            });
            
            // ===== THEME MANAGEMENT =====
            function initThemeSystem() {
                const themeToggle = document.getElementById('theme-toggle');
                const themeIcon = document.getElementById('theme-icon');
                
                // Get saved theme or detect system preference
                const savedTheme = localStorage.getItem('theme');
                const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const initialTheme = savedTheme || (systemPrefersDark ? 'dark' : 'light');
                
                // Apply theme
                document.documentElement.setAttribute('data-theme', initialTheme);
                updateThemeIcon(initialTheme);
                
                // Theme toggle event
                themeToggle.addEventListener('click', function() {
                    const currentTheme = document.documentElement.getAttribute('data-theme');
                    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                    
                    document.documentElement.setAttribute('data-theme', newTheme);
                    localStorage.setItem('theme', newTheme);
                    updateThemeIcon(newTheme);
                    
                    // Announce theme change for screen readers
                    announceToScreenReader(`Theme changed to ${newTheme} mode`);
                });
                
                // Listen for system theme changes
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
                    if (!localStorage.getItem('theme')) {
                        const newTheme = e.matches ? 'dark' : 'light';
                        document.documentElement.setAttribute('data-theme', newTheme);
                        updateThemeIcon(newTheme);
                    }
                });
                
                function updateThemeIcon(theme) {
                    themeIcon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
                    themeToggle.setAttribute('aria-label', `Switch to ${theme === 'dark' ? 'light' : 'dark'} theme`);
                }
            }
            
            // ===== DATE PICKER ENHANCEMENT =====
            function initDatePicker() {
                const dobInput = document.getElementById('dob');
                
                // Set max date to today (can't be born in the future)
                const today = new Date();
                const maxDate = today.toISOString().split('T')[0];
                dobInput.max = maxDate;
                
                // Set a reasonable min date (e.g., 100 years ago)
                const minDate = new Date();
                minDate.setFullYear(today.getFullYear() - 100);
                dobInput.min = minDate.toISOString().split('T')[0];
                
                // Set default placeholder to show date format
                dobInput.setAttribute('placeholder', 'YYYY-MM-DD');
            }
            
            // ===== INITIALIZE DYNAMIC FIELDS FOR NEW ADDITIONS =====
            function initDynamicFields() {
                // Disability field dynamic behavior
                const disabilitySelect = document.getElementById('disability');
                const disabilityOtherField = document.getElementById('disabilityOtherField');
                
                disabilitySelect.addEventListener('change', function() {
                    if (this.value === 'other') {
                        disabilityOtherField.classList.add('show');
                        setTimeout(() => {
                            document.getElementById('disabilityOther').focus();
                        }, 300);
                    } else {
                        disabilityOtherField.classList.remove('show');
                        // Clear other field if not selected
                        document.getElementById('disabilityOther').value = '';
                    }
                });
                
                // Allergies field dynamic behavior
                const allergiesSelect = document.getElementById('allergies');
                const allergiesOtherField = document.getElementById('allergiesOtherField');
                
                allergiesSelect.addEventListener('change', function() {
                    if (this.value === 'other') {
                        allergiesOtherField.classList.add('show');
                        setTimeout(() => {
                            document.getElementById('allergiesOther').focus();
                        }, 300);
                    } else {
                        allergiesOtherField.classList.remove('show');
                        // Clear other field if not selected
                        document.getElementById('allergiesOther').value = '';
                    }
                });
            }
            
            // ===== FORM NAVIGATION =====
            function initFormNavigation() {
                let currentStep = 1;
                const totalSteps = 4;
                
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');
                const submitBtn = document.getElementById('submitBtn');
                const progressText = document.getElementById('progressText');
                const progressFill = document.getElementById('progressFill');
                const progressSteps = document.querySelectorAll('.progress-step');
                
                // Initialize navigation
                updateNavigation();
                
                // Next button click
                nextBtn.addEventListener('click', function() {
                    if (validateCurrentStep()) {
                        if (currentStep < totalSteps) {
                            currentStep++;
                            updateNavigation();
                            announceToScreenReader(`Step ${currentStep}: ${getStepTitle(currentStep)}`);
                        }
                    } else {
                        announceToScreenReader('Please fix validation errors before proceeding');
                    }
                });
                
                // Previous button click
                prevBtn.addEventListener('click', function() {
                    if (currentStep > 1) {
                        currentStep--;
                        updateNavigation();
                        announceToScreenReader(`Step ${currentStep}: ${getStepTitle(currentStep)}`);
                    }
                });
                
                // Keyboard navigation
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'ArrowRight' && e.ctrlKey) {
                        e.preventDefault();
                        nextBtn.click();
                    } else if (e.key === 'ArrowLeft' && e.ctrlKey) {
                        e.preventDefault();
                        prevBtn.click();
                    }
                });
                
                function updateNavigation() {
                    // Update progress bar
                    const progressPercentage = (currentStep / totalSteps) * 100;
                    progressFill.style.width = `${progressPercentage}%`;
                    progressText.textContent = `Step ${currentStep} of ${totalSteps}`;
                    
                    // Update progress steps
                    progressSteps.forEach((step, index) => {
                        const stepNum = index + 1;
                        step.classList.remove('active', 'completed');
                        
                        if (stepNum === currentStep) {
                            step.classList.add('active');
                        } else if (stepNum < currentStep) {
                            step.classList.add('completed');
                        }
                    });
                    
                    // Show/hide sections
                    document.querySelectorAll('.form-section').forEach((section, index) => {
                        const sectionNum = index + 1;
                        const isActive = sectionNum === currentStep;
                        
                        section.classList.toggle('active', isActive);
                        section.hidden = !isActive;
                        
                        if (isActive) {
                            section.setAttribute('aria-hidden', 'false');
                            // Focus first input in active section
                            const firstInput = section.querySelector('input, select, textarea');
                            if (firstInput) {
                                setTimeout(() => firstInput.focus(), 100);
                            }
                        } else {
                            section.setAttribute('aria-hidden', 'true');
                        }
                    });
                    
                    // Update button states
                    prevBtn.style.display = currentStep > 1 ? 'flex' : 'none';
                    nextBtn.style.display = currentStep < totalSteps ? 'flex' : 'none';
                    submitBtn.style.display = currentStep === totalSteps ? 'flex' : 'none';
                    
                    // Update review section if on step 4
                    if (currentStep === 4) {
                        updateReviewSection();
                    }
                }
                
                function getStepTitle(step) {
                    const titles = {
                        1: 'Student Information',
                        2: 'Parent Details',
                        3: 'Contact & Address',
                        4: 'Review & Submit'
                    };
                    return titles[step] || `Step ${step}`;
                }
            }
            
            // ===== FORM VALIDATION =====
            function initFormValidation() {
                // Real-time validation for inputs
                const validatedInputs = document.querySelectorAll('input[required], select[required], textarea[required]');
                
                validatedInputs.forEach(input => {
                    // Validate on blur
                    input.addEventListener('blur', function() {
                        validateField(this);
                    });
                    
                    // Validate on input (for immediate feedback)
                    input.addEventListener('input', function() {
                        if (this.value.trim()) {
                            validateField(this);
                        }
                    });
                });
                
                // Form submission validation
                const form = document.getElementById('enterpriseRegistrationForm');
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    if (validateCurrentStep() && validateReviewSection()) {
                        submitForm();
                    } else {
                        announceToScreenReader('Please fix all validation errors before submitting');
                    }
                });
            }


           // ===== SIMPLE B-FORM CHECK - ONE CLEAN SOLUTION =====
function initBFormCheck() {
    const bFormInput = document.getElementById('bForm');
    const nextBtn = document.getElementById('nextBtn');
    
    // Create ONE message element
    let messageEl = document.getElementById('bform-message');
    if (!messageEl) {
        messageEl = document.createElement('div');
        messageEl.id = 'bform-message';
        messageEl.style.marginTop = '8px';
        messageEl.style.fontSize = '14px';
        messageEl.style.padding = '6px 10px';
        messageEl.style.borderRadius = '6px';
        messageEl.style.transition = 'all 0.3s ease';
        bFormInput.parentNode.appendChild(messageEl);
    }
    
    // Your Google Apps Script URL
    const scriptUrl = 'https://script.google.com/macros/s/AKfycby901e5Zfx5Wcac79sPera7-kUyKyUVFWWEb3W_auZNZYQjdXBuVeSfQWwqOyHfrINM/exec';
    
    let checkTimeout = null;
    
    // Function to check B-Form
    async function checkBForm(bForm) {
        try {
            // Show checking
            messageEl.innerHTML = '‚è≥ Checking B-Form...';
            messageEl.style.backgroundColor = '#f0f0f0';
            messageEl.style.color = '#666';
            messageEl.style.border = '1px solid #ddd';
            
            const response = await fetch(`${scriptUrl}?action=checkBForm&bForm=${encodeURIComponent(bForm)}`);
            const data = await response.json();
            
            if (data.success && data.exists === true) {
                // DUPLICATE - Show error, disable next
                messageEl.innerHTML = '‚ùå This B-Form is already registered';
                messageEl.style.backgroundColor = '#ffebee';
                messageEl.style.color = '#c62828';
                messageEl.style.border = '1px solid #ef5350';
                bFormInput.style.borderColor = '#c62828';
                nextBtn.disabled = true;
                
            } else if (data.success && data.exists === false) {
                // UNIQUE - Show success, enable next
                messageEl.innerHTML = '‚úÖ B-Form is available';
                messageEl.style.backgroundColor = '#e8f5e9';
                messageEl.style.color = '#2e7d32';
                messageEl.style.border = '1px solid #66bb6a';
                bFormInput.style.borderColor = '#2e7d32';
                nextBtn.disabled = false;
                
            } else {
                // Error
                messageEl.innerHTML = '‚ö†Ô∏è Could not verify. Please try again.';
                messageEl.style.backgroundColor = '#fff3e0';
                messageEl.style.color = '#ef6c00';
                messageEl.style.border = '1px solid #ff9800';
            }
            
        } catch (error) {
            messageEl.innerHTML = '‚ö†Ô∏è Network error. Please check connection.';
            messageEl.style.backgroundColor = '#ffebee';
            messageEl.style.color = '#c62828';
            messageEl.style.border = '1px solid #ef5350';
        }
    }
    
    // Input event
    bFormInput.addEventListener('input', function() {
        if (checkTimeout) clearTimeout(checkTimeout);
        
        const bForm = this.value.trim();
        
        // Clear if empty
        if (!bForm) {
            messageEl.innerHTML = '';
            messageEl.style.backgroundColor = 'transparent';
            messageEl.style.border = 'none';
            bFormInput.style.borderColor = '';
            nextBtn.disabled = false;
            return;
        }
        
        // Check format
        const bFormPattern = /^\d{5}-\d{7}-\d$/;
        if (!bFormPattern.test(bForm)) {
            messageEl.innerHTML = '‚ö†Ô∏è Format: XXXXX-XXXXXXX-X';
            messageEl.style.backgroundColor = '#fff3e0';
            messageEl.style.color = '#ef6c00';
            messageEl.style.border = '1px solid #ff9800';
            bFormInput.style.borderColor = '#ef6c00';
            nextBtn.disabled = true;
            return;
        }
        
        // Check after 500ms
        checkTimeout = setTimeout(() => checkBForm(bForm), 500);
    });
    
    // Prevent next if duplicate
    nextBtn.addEventListener('click', function(e) {
        const activeSection = document.querySelector('.form-section.active');
        if (activeSection && activeSection.id === 'step-1-section') {
            if (messageEl.innerHTML.includes('‚ùå') || messageEl.innerHTML.includes('‚ö†Ô∏è Format')) {
                e.preventDefault();
                e.stopPropagation();
                return false;
            }
        }
    });
    
    console.log('‚úÖ B-Form check ready');
}

// Call this function in your DOMContentLoaded
// Add this line inside your existing DOMContentLoaded function:
// initBFormCheck();


            
            
            function validateCurrentStep() {
                const currentSection = document.querySelector('.form-section.active');
                const requiredFields = currentSection.querySelectorAll('[required]');
                let isValid = true;
                
                requiredFields.forEach(field => {
                    if (!validateField(field)) {
                        isValid = false;
                    }
                });
                
                return isValid;
            }
            
            function validateField(field) {
                const value = field.value.trim();
                const fieldId = field.id;
                const validationEl = document.getElementById(`${fieldId}Validation`);
                
                // Clear previous validation
                field.classList.remove('error', 'success');
                
                // Check if required field is empty
                if (field.hasAttribute('required') && !value) {
                    showValidationError(field, validationEl, 'This field is required');
                    return false;
                }
                
                // Field-specific validation
                switch(field.type) {
                    case 'email':
                        if (value && !isValidEmail(value)) {
                            showValidationError(field, validationEl, 'Please enter a valid email address');
                            return false;
                        }
                        break;
                    
                    case 'tel':
                        if (value && !isValidInternationalPhone(value)) {
                            showValidationError(field, validationEl, 'Please enter a valid phone number');
                            return false;
                        }
                        break;
                    
                    case 'date':
                        if (value && !isValidDate(value)) {
                            showValidationError(field, validationEl, 'Please enter a valid date');
                            return false;
                        }
                        break;
                }
                
                // CNIC validation
                if (field.id.includes('Cnic') && value) {
                    if (!isValidCNIC(value)) {
                        showValidationError(field, validationEl, 'Please enter a valid CNIC (XXXXX-XXXXXXX-X)');
                        return false;
                    }
                }
                
                // Show success state
                showValidationSuccess(field, validationEl);
                return true;
            }
            
            function showValidationError(field, validationEl, message) {
                field.classList.add('error');
                field.setAttribute('aria-invalid', 'true');
                
                if (validationEl) {
                    validationEl.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
                    validationEl.className = 'validation-message error';
                }
            }
            
            function showValidationSuccess(field, validationEl) {
                field.classList.remove('error');
                field.classList.add('success');
                field.setAttribute('aria-invalid', 'false');
                
                if (validationEl) {
                    validationEl.innerHTML = '<i class="fas fa-check-circle"></i> Valid';
                    validationEl.className = 'validation-message success';
                }
            }
            
            // Validation helpers
            function isValidEmail(email) {
                return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
            }
            
            function isValidInternationalPhone(phone) {
                // Accepts all international phone formats
                // Allows +, country codes, spaces, dashes, parentheses
                return /^[\+]?[0-9\s\-\(\)]{8,}$/.test(phone);
            }
            
            function isValidDate(date) {
                return !isNaN(Date.parse(date));
            }
            
            function isValidCNIC(cnic) {
                return /^\d{5}-\d{7}-\d$/.test(cnic);
            }
            
            // ===== FILE UPLOAD =====
            function initFileUpload() {
                const fileUploadArea = document.getElementById('photoUploadArea');
                const fileInput = document.getElementById('photoUpload');
                const maxSize = 2 * 1024 * 1024; // 2MB
                
                // Click to upload
                fileUploadArea.addEventListener('click', function() {
                    fileInput.click();
                });
                
                // Drag and drop
                fileUploadArea.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('dragover');
                });
                
                fileUploadArea.addEventListener('dragleave', function() {
                    this.classList.remove('dragover');
                });
                
                fileUploadArea.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                    
                    if (e.dataTransfer.files.length) {
                        handleFileSelect(e.dataTransfer.files[0]);
                    }
                });
                
                // File input change
                fileInput.addEventListener('change', function() {
                    if (this.files.length) {
                        handleFileSelect(this.files[0]);
                    }
                });
                
                function handleFileSelect(file) {
                    // Validate file
                    if (!file.type.match('image.*')) {
                        showFileError('Please select an image file (JPG, PNG)');
                        return;
                    }
                    
                    if (file.size > maxSize) {
                        showFileError('File size exceeds 2MB limit');
                        return;
                    }
                    
                    // Preview file
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        fileUploadArea.innerHTML = `
                            <div class="file-upload-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="file-upload-text">${file.name}</div>
                            <div class="file-upload-subtext">${(file.size / 1024 / 1024).toFixed(2)} MB ‚Ä¢ Click to change</div>
                        `;
                        
                        // Reattach events
                        fileUploadArea.addEventListener('click', function() {
                            fileInput.click();
                        });
                    };
                    
                    reader.readAsDataURL(file);
                    
                    // Update validation
                    const validationEl = document.getElementById('photoValidation');
                    showValidationSuccess(fileInput, validationEl);
                }
                
                function showFileError(message) {
                    fileUploadArea.innerHTML = `
                        <div class="file-upload-icon">
                            <i class="fas fa-exclamation-circle"></i>
                        </div>
                        <div class="file-upload-text">${message}</div>
                        <div class="file-upload-subtext">Click to try again</div>
                    `;
                    
                    fileInput.value = '';
                }
            }
            
            // ===== INPUT FORMATTING =====
            function initInputFormatting() {
                // CNIC formatting
                const cnicInputs = document.querySelectorAll('input[id$="Cnic"]');
                cnicInputs.forEach(input => {
                    input.addEventListener('input', function(e) {
                        let value = e.target.value.replace(/\D/g, '');
                        
                        if (value.length > 13) {
                            value = value.substring(0, 13);
                        }
                        
                        if (value.length > 5) {
                            value = value.substring(0, 5) + '-' + value.substring(5);
                        }
                        
                        if (value.length > 13) {
                            value = value.substring(0, 13) + '-' + value.substring(13);
                        }
                        
                        e.target.value = value;
                    });
                });
                
                // Phone number formatting with dynamic prefix hiding
                const phoneInputs = {
                    'primaryMobile': 'primaryMobilePrefix',
                    'whatsappNumber': 'whatsappPrefix',
                    'emergencyContact': 'emergencyPrefix'
                };
                
                Object.keys(phoneInputs).forEach(inputId => {
                    const input = document.getElementById(inputId);
                    const prefix = document.getElementById(phoneInputs[inputId]);
                    
                    if (input && prefix) {
                        // Hide prefix when user starts typing
                        input.addEventListener('input', function(e) {
                            const value = e.target.value.trim();
                            
                            // Hide prefix if user starts with + or international code
                            if (value.startsWith('+') || value.startsWith('00')) {
                                prefix.classList.add('hidden');
                            } else if (value.length > 0) {
                                prefix.classList.add('hidden');
                            } else {
                                prefix.classList.remove('hidden');
                            }
                            
                            // Format phone number for better readability
                            formatPhoneNumber(e.target);
                        });
                        
                        // Show prefix again when field is empty
                        input.addEventListener('blur', function(e) {
                            if (!e.target.value.trim()) {
                                prefix.classList.remove('hidden');
                            }
                        });
                    }
                });
                
                // Phone number formatting function
                function formatPhoneNumber(input) {
                    let value = input.value.replace(/\D/g, '');
                    
                    // Don't format if user is entering international number
                    if (input.value.startsWith('+') || input.value.startsWith('00')) {
                        return; // Let user enter their own format
                    }
                    
                    // Format Pakistani numbers
                    if (value.startsWith('92')) {
                        value = '+92 ' + value.substring(2);
                    }
                    
                    // Add spaces for readability
                    if (value.length > 4) {
                        value = value.substring(0, 4) + ' ' + value.substring(4);
                    }
                    if (value.length > 8) {
                        value = value.substring(0, 8) + ' ' + value.substring(8);
                    }
                    
                    input.value = value;
                }
                
                // Dynamic field for last school attended
                const lastSchoolYes = document.getElementById('lastSchoolYes');
                const lastSchoolNo = document.getElementById('lastSchoolNo');
                const lastSchoolFields = document.getElementById('lastSchoolFields');
                
                lastSchoolYes.addEventListener('change', function() {
                    if (this.checked) {
                        lastSchoolFields.classList.add('show');
                        setTimeout(() => {
                            document.getElementById('lastSchoolName').focus();
                        }, 300);
                    }
                });
                
                lastSchoolNo.addEventListener('change', function() {
                    if (this.checked) {
                        lastSchoolFields.classList.remove('show');
                    }
                });
                
                // Address copy functionality
                const sameAddressToggle = document.getElementById('sameAddressToggle');
                sameAddressToggle.addEventListener('click', function() {
                    const currentAddress = document.getElementById('currentAddress').value;
                    const permanentAddress = document.getElementById('permanentAddress');
                    
                    permanentAddress.value = currentAddress;
                    validateField(permanentAddress);
                    
                    // Visual feedback
                    const originalHTML = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Address Copied!';
                    this.style.backgroundColor = 'var(--accent-success)';
                    this.style.borderColor = 'var(--accent-success)';
                    this.style.color = 'white';
                    
                    setTimeout(() => {
                        this.innerHTML = originalHTML;
                        this.style.backgroundColor = '';
                        this.style.borderColor = '';
                        this.style.color = '';
                    }, 2000);
                    
                    announceToScreenReader('Current address copied to permanent address');
                });
            }
            
            // ===== REVIEW SECTION =====
            function updateReviewSection() {
                const fields = {
                    'review-student-name': () => {
                        const firstName = document.getElementById('firstName').value;
                        const lastName = document.getElementById('lastName').value;
                        return `${firstName} ${lastName}`.trim() || '--';
                    },
                    'review-dob': () => formatDate(document.getElementById('dob').value),
                    'review-class': () => document.getElementById('classApplied').value || '--',
                    'review-gender': () => {
                        const gender = document.querySelector('input[name="gender"]:checked');
                        return gender ? gender.value.charAt(0).toUpperCase() + gender.value.slice(1) : '--';
                    },
                    'review-father-name': () => document.getElementById('fatherName').value || '--',
                    'review-mother-name': () => document.getElementById('motherName').value || '--',
                    'review-email': () => document.getElementById('primaryEmail').value || '--',
                    'review-mobile': () => document.getElementById('primaryMobile').value || '--',
                    // New review fields
                    'review-blood-group': () => {
                        const bloodGroup = document.getElementById('bloodGroup').value;
                        return bloodGroup || '--';
                    },
                    'review-mother-tongue': () => {
                        const motherTongue = document.getElementById('motherTongue').value;
                        return motherTongue || '--';
                    },
                    'review-disability': () => {
                         const disability = document.getElementById('disability').value;
                         if (!disability || disability === '') return 'None';
                         if (disability === 'other') {
                         const other = document.getElementById('disabilityOther').value;
                         return other || 'None';  // CHANGED from 'Other (Not Specified)' to 'None'
                  }
                  // Convert value to readable text
                  const disabilityMap = {
                       'autism': 'Autism Spectrum Disorder',
                       'adhd': 'Attention Deficit Hyperactivity Disorder (ADHD)',
                       'dyslexia': 'Dyslexia',
                       'dyscalculia': 'Dyscalculia',
                       'hearing_impairment': 'Hearing Impairment',
                       'visual_impairment': 'Visual Impairment',
                       'speech_disorder': 'Speech Disorder',
                       'cerebral_palsy': 'Cerebral Palsy',
                       'down_syndrome': 'Down Syndrome',
                       'learning_disability': 'Learning Disability'
               };
                       return disabilityMap[disability] || disability;
               },
              'review-allergies': () => {
                       const allergies = document.getElementById('allergies').value;
                       if (!allergies || allergies === '') return 'None';
                       if (allergies === 'other') {
                       const other = document.getElementById('allergiesOther').value;
                       return other || 'None';  // CHANGED from 'Other (Not Specified)' to 'None'
               }
              // Convert value to readable text
                      const allergiesMap = {
                     'peanut': 'Peanut Allergy',
                     'dairy': 'Dairy/Lactose Intolerance',
                     'egg': 'Egg Allergy',
                     'gluten': 'Gluten Intolerance/Celiac',
                     'shellfish': 'Shellfish Allergy',
                     'soy': 'Soy Allergy',
                     'tree_nut': 'Tree Nut Allergy',
                     'wheat': 'Wheat Allergy',
                     'fish': 'Fish Allergy',
                     'bee_sting': 'Bee Sting Allergy'
          };
                      return allergiesMap[allergies] || allergies;
          }
                };
                
                Object.entries(fields).forEach(([id, getValue]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = getValue();
                    }
                });
            }
            
            function validateReviewSection() {
                const termsAgreement = document.getElementById('termsAgreement');
                const privacyAgreement = document.getElementById('privacyAgreement');
                
                if (!termsAgreement.checked || !privacyAgreement.checked) {
                    announceToScreenReader('Please agree to the terms and privacy policy');
                    return false;
                }
                
                return true;
            }
            
            function formatDate(dateString) {
                if (!dateString) return '--';
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }
            
            // ============================================
// 1. THE MESSAGE LISTENER - Wait for Google's response
// ============================================
window.addEventListener('message', function(event) {
    // Safety check: Only accept messages from Google domains
    if (!event.origin.includes('google.com') && !event.origin.includes('script.googleusercontent.com')) {
        return;
    }

    if (event.data && event.data.success) {
        const submitBtn = document.getElementById('submitBtn');
        
        // Visual success state
        submitBtn.innerHTML = '<i class="fas fa-check"></i> Registration Successful!';
        submitBtn.style.background = 'var(--accent-success)';
        
        if (typeof announceToScreenReader === "function") {
            announceToScreenReader('Registration submitted successfully. ID: ' + event.data.registrationId);
        }

        // Reset form after 3 seconds
        setTimeout(() => {
            // Reload the page to ensure clean form
            window.location.reload();
        }, 3000);
    } else if (event.data && !event.data.success) {
        // Handle error message from script
        const submitBtn = document.getElementById('submitBtn');
        submitBtn.innerHTML = '<i class="fas fa-exclamation-circle"></i> Error: ' + (event.data.message || 'Try Again');
        submitBtn.style.background = 'var(--accent-danger)';
        submitBtn.setAttribute('aria-busy', 'false');
        
        // Re-enable form
        document.querySelectorAll('input, select, textarea, button').forEach(el => {
            el.disabled = false;
        });
    }
});

// ============================================
// 2. THE SUBMIT FUNCTION - Send data to Google
// ============================================
function submitForm() {
    const submitBtn = document.getElementById('submitBtn');
    const originalText = submitBtn.innerHTML;
    
    // Disable form and show loading state
    document.querySelectorAll('input, select, textarea, button').forEach(el => {
        el.disabled = true;
    });
    
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
    submitBtn.setAttribute('aria-busy', 'true');
    
    // COLLECT ALL FORM DATA
    const formDataObject = {
        // === STUDENT INFORMATION ===
        firstName: document.getElementById('firstName')?.value || '',
        lastName: document.getElementById('lastName')?.value || '',
        dob: document.getElementById('dob')?.value || '',
        gender: document.querySelector('input[name="gender"]:checked')?.value || '',
        bloodGroup: document.getElementById('bloodGroup')?.value || '',
        motherTongue: document.getElementById('motherTongue')?.value || '',
        disability: document.getElementById('disability')?.value || '',
        disabilityOther: document.getElementById('disabilityOther')?.value || '',
        allergies: document.getElementById('allergies')?.value || '',
        allergiesOther: document.getElementById('allergiesOther')?.value || '',
        caste: document.getElementById('caste')?.value || '',
        placeOfBirth: document.getElementById('placeOfBirth')?.value || '',
        bForm: document.getElementById('bForm')?.value || '',
        nationality: document.getElementById('nationality')?.value || '',
        religion: document.getElementById('religion')?.value || '',
        classApplied: document.getElementById('classApplied')?.value || '',
        lastSchoolAttended: document.querySelector('input[name="lastSchoolAttended"]:checked')?.value || '',
        lastSchoolName: document.getElementById('lastSchoolName')?.value || '',
        grNumber: document.getElementById('grNumber')?.value || '',
        photoUpload: document.getElementById('photoUpload')?.files[0]?.name || '',
        
        // === PARENT INFORMATION ===
        fatherName: document.getElementById('fatherName')?.value || '',
        fatherCnic: document.getElementById('fatherCnic')?.value || '',
        fatherOccupation: document.getElementById('fatherOccupation')?.value || '',
        motherName: document.getElementById('motherName')?.value || '',
        motherCnic: document.getElementById('motherCnic')?.value || '',
        motherOccupation: document.getElementById('motherOccupation')?.value || '',
        
        // === CONTACT DETAILS ===
        primaryEmail: document.getElementById('primaryEmail')?.value || '',
        primaryMobile: document.getElementById('primaryMobile')?.value || '',
        whatsappNumber: document.getElementById('whatsappNumber')?.value || '',
        emergencyContact: document.getElementById('emergencyContact')?.value || '',
        currentAddress: document.getElementById('currentAddress')?.value || '',
        permanentAddress: document.getElementById('permanentAddress')?.value || ''
    };
    
    // Your Google Apps Script URL
    const scriptUrl = 'https://script.google.com/macros/s/AKfycby901e5Zfx5Wcac79sPera7-kUyKyUVFWWEb3W_auZNZYQjdXBuVeSfQWwqOyHfrINM/exec';
    
    // Create a unique iframe name
    const iframeName = 'submitFrame_' + Date.now();
    
    // Create hidden iframe
    const iframe = document.createElement('iframe');
    iframe.name = iframeName;
    iframe.style.display = 'none';
    document.body.appendChild(iframe);
    
    // Create hidden form
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = scriptUrl;
    form.target = iframeName;
    form.style.display = 'none';
    
    // Add all data as hidden fields
    for (const [key, value] of Object.entries(formDataObject)) {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = key;
        input.value = value;
        form.appendChild(input);
    }
    
    // Add a special field to identify this as form submission
    const flag = document.createElement('input');
    flag.type = 'hidden';
    flag.name = 'formSubmission';
    flag.value = 'true';
    form.appendChild(flag);
    
    document.body.appendChild(form);
    
    // Set a timeout in case Google doesn't respond
    const timeoutId = setTimeout(() => {
        // If we haven't heard back in 10 seconds, assume success
        // (This is a fallback - the message listener should handle it)
        console.log('No response received, assuming success');
        
        submitBtn.innerHTML = '<i class="fas fa-check"></i> Registration Successful!';
        submitBtn.style.background = 'var(--accent-success)';
        
        setTimeout(() => {
            window.location.reload();
        }, 3000);
    }, 10000);
    
    // Listen for response and clear timeout
    const responseHandler = function(event) {
        if (event.data && event.data.registrationId) {
            clearTimeout(timeoutId);
            window.removeEventListener('message', responseHandler);
        }
    };
    window.addEventListener('message', responseHandler);
    
    // Submit the form
    try {
        form.submit();
        console.log('Form submitted successfully');
    } catch (error) {
        console.error('Submission error:', error);
        clearTimeout(timeoutId);
        
        submitBtn.innerHTML = '<i class="fas fa-exclamation-circle"></i> Error! Try Again';
        submitBtn.style.background = 'var(--accent-danger)';
        submitBtn.setAttribute('aria-busy', 'false');
        
        // Re-enable form
        document.querySelectorAll('input, select, textarea, button').forEach(el => {
            el.disabled = false;
        });
        
        // Clean up
        setTimeout(() => {
            if (document.body.contains(iframe)) document.body.removeChild(iframe);
            if (document.body.contains(form)) document.body.removeChild(form);
        }, 1000);
    }
}
            
            // ===== ACCESSIBILITY =====
            function initAccessibility() {
                // Focus management
                document.addEventListener('focusin', function(e) {
                    e.target.classList.add('focus-visible');
                });
                
                document.addEventListener('focusout', function(e) {
                    e.target.classList.remove('focus-visible');
                });
                
                // Skip to main content
                const skipLink = document.querySelector('a[href="#main-content"]');
                skipLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    const mainContent = document.getElementById('main-content');
                    mainContent.tabIndex = -1;
                    mainContent.focus();
                    setTimeout(() => mainContent.removeAttribute('tabindex'), 100);
                });
                
                // ARIA live regions
                const liveRegion = document.createElement('div');
                liveRegion.className = 'sr-only';
                liveRegion.setAttribute('aria-live', 'assertive');
                liveRegion.setAttribute('aria-atomic', 'true');
                document.body.appendChild(liveRegion);
                
                window.announceToScreenReader = function(message) {
                    liveRegion.textContent = message;
                    setTimeout(() => liveRegion.textContent = '', 1000);
                };
            }
            
            // ===== MICRO-INTERACTIONS =====
            function initMicroInteractions() {
                // Hover effects
                document.querySelectorAll('.btn').forEach(btn => {
                    btn.addEventListener('mouseenter', function() {
                        this.style.transform = 'translateY(-1px)';
                    });
                    
                    btn.addEventListener('mouseleave', function() {
                        this.style.transform = 'translateY(0)';
                    });
                });
                
                // Ripple effect for buttons
                document.querySelectorAll('.btn').forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        const ripple = document.createElement('span');
                        const rect = this.getBoundingClientRect();
                        const size = Math.max(rect.width, rect.height);
                        const x = e.clientX - rect.left - size / 2;
                        const y = e.clientY - rect.top - size / 2;
                        
                        ripple.style.cssText = `
                            position: absolute;
                            border-radius: 50%;
                            background: rgba(255, 255, 255, 0.7);
                            transform: scale(0);
                            animation: ripple 0.6s linear;
                            width: ${size}px;
                            height: ${size}px;
                            top: ${y}px;
                            left: ${x}px;
                        `;
                        
                        this.appendChild(ripple);
                        setTimeout(() => ripple.remove(), 600);
                    });
                });
                
                // Add ripple animation
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes ripple {
                        to {
                            transform: scale(4);
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(style);
            }
            
            // ===== SYSTEM STATISTICS =====
            function updateSystemStats(newRegistration = false) {
                const uptimeEl = document.getElementById('footer-uptime');
                const securityEl = document.getElementById('footer-security');
                const registrationsEl = document.getElementById('footer-registrations');
                
                // Simulate real-time updates
                if (newRegistration) {
                    const currentCount = parseInt(registrationsEl.textContent) || 0;
                    registrationsEl.textContent = currentCount + 1;
                }
                
                // Update uptime (simulated)
                uptimeEl.textContent = '99.9%';
                securityEl.textContent = 'A+';
            }
        })();
    </script>
</body>
</html>
